{
    "Security::STIGS":
    {
        "fix": false,

        "definitions":
        {
            "GEN000020": { "enabled": true, "desc": "Modifies /etc/inittab, restarts inittab if repaired. Requires password to enter single user mode." },
            "GEN000040": { "enabled": true, "desc": "Modifies /etc/inittab, restarts inittab if repaired. Requires password to enter single user mode." },
            "GEN000060": { "enabled": true, "desc": "Modifies /etc/inittab, restarts inittab if repaired. Requires password to enter single user mode." },

            "GEN000440": { "enabled": true, "desc": "Modifies /etc/syslog.conf. MOG. Restarts syslog on repair.Sends Authentication log to /var/log/secure." },

            "GEN000460": { "enabled": true, "desc": " /etc/pam.d/system-auth Three Failed Login Attempts, copy from master configuration if promise fails." },

            "GEN000480": { "enabled": true, "desc": "login defs - password guidelines" },

            "GEN000500": { "enabled": true, "desc": "Modifies /etc/profile. Set TMOUT to lock screen after 15 min." },

            "GEN000540": { "enabled": true, "desc": "login defs - password guidelines" },

            "GEN000560": { "enabled": false, "desc": "Modifies /etc/passwd based on passwords in /etc/shadow. Disables Accounts without passwords. Sets shell to /sbin/nologin. This list needs to be reviewed and what about LDAP checks?" },

            "GEN000580": { "enabled": true, "desc": "login defs - password guidelines" },

            "GEN000600": { "enabled": true, "desc": "/etc/pam.d/system-auth Password Character Mix, uppercase/lowercase requirement copy from master configuration if promise fails." },

            "GEN000620": { "enabled": true, "desc": "/etc/pam.d/system-auth Password Character Mix, digit requirement. copy from master configuration if promise fails." },

            "GEN000640": { "enabled": true, "desc": "/etc/pam.d/system-auth Password Character Mix, special character requirement copy from master configuration if promise fails." },

            "GEN000700": { "enabled": true, "desc": "login defs - password guidelines" },

            "GEN000800": { "enabled": true, "desc": "/etc/pam.d/system-auth Password Reuse policy >=5." },

            "GEN000820": { "enabled": true, "desc": "login defs - password guidelines" },

            "GEN000900": { "enabled": true, "desc": "Modifies /etc/passwd. MOG. Sets root home directory to /root." },

            "GEN000920": { "enabled": true, "desc": "!Mog's /root. " },

            "GEN000980": { "enabled": false, "desc": "!Allows root only from system console. Empties /etc/securetty before edit.Mog's /etc/securetty.(Deletes lines and inserts line 'console')" },

            "GEN001000": { "enabled": false, "desc": "!Allows root only from system console. Empties /etc/securetty before edit.Mog's /etc/securetty.(Inserts line 'console' only)" },

            "GEN001020": { "enabled": false, "desc": " This one could prevent root login remotely!Edits Pamd config,#!Mog's /etc/security/access.conf.Modifies /etc/security/access.conf." },

            "GEN001080": { "enabled": true, "desc": " Disables root shells in /usr/bin. Set root shell to /bin/bash." },

            "GEN001120": { "enabled": false, "desc": " Modify /etc/ssh/sshd_config. PREVENTS ROOT SSH!!!" },

            "GEN001160": { "enabled": false, "desc": "Scan for orphaned files, change owner and group where necessary. Currently takes forever, unverified!" },

            "GEN001180": { "enabled": true, "desc": "!Mog's network services daemon files." },

            "GEN001220": { "enabled": true, "desc": "!Mog's System directories(/etc, /bin, /sbin, /usr/sbin, /usr/sbin)" },
            "GEN001240": { "enabled": true, "desc": "!Mog's System directories(/etc, /bin, /sbin, /usr/sbin, /usr/sbin)" },

            "GEN001260": { "enabled": true, "desc": "!Sets mode on system log files." },

            "GEN001280": { "enabled": true, "desc": "!Sets mode on man page files." },

            "GEN001300": { "enabled": true, "desc": "!Sets mode on libarary files in library dirs." },

            "GEN001320": { "enabled": true, "desc": "deals with NIS and NIS files." },
            "GEN001340": { "enabled": true, "desc": "deals with NIS and NIS files." },
            "GEN001360": { "enabled": true, "desc": "deals with NIS and NIS files." },

            "GEN001380": { "enabled": true, "desc": "!Mog's /etc/passwd." },

            "GEN001400": { "enabled": true, "desc": "!Mog's /etc/shadow. Mog's /etc/passwd" },

            "GEN001420": { "enabled": true, "desc": "!Mog's /etc/shadow." },

            "GEN001440": { "enabled": false, "desc": "!Mog's users home directories.(Username:Wheel) " },

            "GEN001460": { "enabled": false, "desc": "!Mog's users home directories.(Username:Wheel) if '/var/lib/avahi-autoipd/.' does not exist, create it. Set Mode. Avahi-autoipd does not seem to have anything to do with the stig requirement 'interactive user assigned home dirs'." },

            "GEN001480": { "enabled": false, "desc": "!Mog's users home directories.(Username:Wheel)" },
            "GEN001500": { "enabled": false, "desc": "!Mog's users home directories.(Username:Wheel)" },
            "GEN001520": { "enabled": false, "desc": "!Mog's users home directories.(Username:Wheel)" },
            "GEN001540": { "enabled": true, "desc": "!Mog's users home directories.(Username:Wheel)" },

            "GEN001560": { "enabled": true, "desc": "!Mog's users home directories.(Username:Wheel) #!Sets umask in bash and cshell rc files." },

            "GEN001580": { "enabled": true, "desc": "!Mog's /etc/rc.d/init.d/* files, excludes iptables.Mog's /etc/rc.d/(rc files)." },
            "GEN001620": { "enabled": true, "desc": "!Mog's /etc/rc.d/init.d/* files, excludes iptables.Mog's /etc/rc.d/(rc files)." },
            "GEN001640": { "enabled": true, "desc": "!Mog's /etc/rc.d/init.d/* files, excludes iptables.Mog's /etc/rc.d/(rc files)." },
            "GEN001660": { "enabled": true, "desc": "!Mog's /etc/rc.d/init.d/* files, excludes iptables.Mog's /etc/rc.d/(rc files)." },
            "GEN001680": { "enabled": true, "desc": "!Mog's /etc/rc.d/init.d/* files, excludes iptables.Mog's /etc/rc.d/(rc files)." },
            "GEN001700": { "enabled": true, "desc": "!Mog's /etc/rc.d/init.d/* files, excludes iptables.Mog's /etc/rc.d/(rc files)." },

            "GEN001720": { "enabled": true, "desc": "!Mog's Global Init files.(/etc/profile, /etc/bashrc,/etc/environment) Appends 'mesg n' if it doesn't exist." },

            "GEN001740": { "enabled": true, "desc": "!Mog's Global Init files. Appends 'mesg n' if it doesn't exist." },
            "GEN001760": { "enabled": true, "desc": "!Mog's Global Init files. Appends 'mesg n' if it doesn't exist." },
            "GEN001780": { "enabled": true, "desc": "!Mog's Global Init files. Appends 'mesg n' if it doesn't exist." },

            "GEN001800": { "enabled": true, "desc": "!Mog's skeleton dot files" },

            "GEN001820": { "enabled": true, "desc": "!Mog's skeleton dot files" },

            "GEN001860": { "enabled": true, "desc": "!Mog's users home directories." },

            "GEN001880": { "enabled": true, "desc": "!Mog's excluded local init files in users home dirs." },

            "GEN001920": { "enabled": true, "desc": "!Mog's users home directories." },
            "GEN001940": { "enabled": true, "desc": "!Mog's users home directories." },

            "GEN001960": { "enabled": true, "desc": "!Removes mesg file from users home dirs. " },

            "GEN002040": { "enabled": true, "desc": "!For files /root/.rhosts and .shosts and /etc/hosts.equiv, delete them if they arent symlinks, then create a symlink to /dev/null" },

            "GEN002100": { "enabled": true, "desc": "!Comments lines in pam files matching '^auth.*pam_rhosts_auth.so' in /etc/pam.d/ekshell and kshell. " },

            "GEN002120": { "enabled": true, "desc": "!Creates/Mog's /etc/shells. Destructively Edits /etc/shells." },

            "GEN002160": { "enabled": true, "desc": "!Mog's shell files." },
            "GEN002180": { "enabled": true, "desc": "!Mog's shell files." },
            "GEN002200": { "enabled": true, "desc": "!Mog's shell files." },
            "GEN002220": { "enabled": true, "desc": "!Mog's shell files." },

            "GEN002320": { "enabled": false, "desc": "!Append a line to /etc/udev/rules.d/55-audio-perms.rules - FIX ME." },
            "GEN002340": { "enabled": false, "desc": "!Append a line to /etc/udev/rules.d/55-audio-perms.rules - FIX ME." },
            "GEN002360": { "enabled": false, "desc": "!Append a line to /etc/udev/rules.d/55-audio-perms.rules - FIX ME." },

            "GEN002420": { "enabled": true, "desc": "!Sets filesystems to mount with nosuid/" },

            "GEN002480": { "enabled": true, "desc": "!Changes mode on /var/cfengine/state/cf_incoming.* " },

            "GEN002560": { "enabled": true, "desc": "!Sets umask in bash and cshell rc files." },

            "GEN002640": { "enabled": true, "desc": "!Edits /etc/passwd, Sets false shell to users with UID < 500" },

            "GEN002660": { "enabled": true, "desc": "!Enables Auditing and causes kernel panic if Auditd fails. Sets Audit buffer to 8192. " },

            "GEN002680": { "enabled": true, "desc": "!Sets mode on Audit log files." },

            "GEN002700": { "enabled": true, "desc": "!Sets mode on system log files." },

            "GEN002720": { "enabled": true, "desc": "Depends on GEN002660, audit rules for failed file access attempts." },

            "GEN002740": { "enabled": true, "desc": "Depends on GEN002660, audit rules for Audit File and Program Deletion." },

            "GEN002760": { "enabled": true, "desc": "Depends on GEN002660, audit rules for Audit Administrative, Privileged, and Security Actions." },

            "GEN002800": { "enabled": true, "desc": "Depends on GEN002660, audit rules for login/logout." },

            "GEN002820": { "enabled": true, "desc": "Depends on GEN002660, audit rules for sysad actions." },

            "GEN002860": { "enabled": true, "desc": "!Mog's /etc/logrotate.d/audit,--HIRSCH disabled mog changes,not called for by stig. This should probably be customized! Destructively edits /etc/logrotate.d/audit to rotate audit logs daily." },

            "GEN002960": { "enabled": true, "desc": "!Mog's /etc/cron.allow. Destructively Edits /etc/cron.allow to add cron users.#!Mog's /etc/cron.deny. Destructively edits /etc/cron.deny. Appends line 'ALL' if it doesn't exist." },

            "GEN002980": { "enabled": true, "desc": "!Mog's /etc/cron.allow." },

            "GEN003040": { "enabled": true, "desc": "!Mog's associated cron files." },

            "GEN003060": { "enabled": true, "desc": "!Mog's /etc/cron.allow. #!Mog's /etc/cron.deny, Destructively edits /etc/cron.deny. Appends line 'ALL' if it doesn't exist." },

            "GEN003080": { "enabled": true, "desc": "!Mog's associated cron files." },

            "GEN003100": { "enabled": true, "desc": "!Mog's cron directories and files recursing once." },
            "GEN003120": { "enabled": true, "desc": "!Mog's cron directories and files recursing once." },
            "GEN003140": { "enabled": true, "desc": "!Mog's cron directories and files recursing once. " },

            "GEN003160": { "enabled": true, "desc": "!Mog's /etc/syslog.conf. Restarts syslog on repair. Send cron logs to /var/log/cron." },

            "GEN003180": { "enabled": true, "desc": "!Mog's all /var/log/cron.* files." },

            "GEN003200": { "enabled": true, "desc": "!Mog's /etc/crond.deny, Destructively edits /etc/cron.deny. Appends line 'ALL' if it doesn't exist." },

            "GEN003240": { "enabled": true, "desc": "!Mog's /etc/cron.allow. " },

            "GEN003260": { "enabled": true, "desc": "!Mog's /etc/cron.deny, Destructively edits /etc/cron.deny. Appends line 'ALL' if it doesn't exist." },

            "GEN003280": { "enabled": true, "desc": "!Mog's /etc/at.deny, Edits /etc/at.deny to add restricted users" },
            "GEN003300": { "enabled": true, "desc": "!Mog's /etc/at.deny, Edits /etc/at.deny to add restricted users" },

            "GEN003320": { "enabled": false, "desc": "!Mog's /etc/at.deny, Mogs /etc/at.allow, Destructively edits /etc/at.allow to remove restricted users. Edits /etc/at.deny to add restricted users" },

            "GEN003340": { "enabled": false, "desc": "!Mog's /etc/at.deny, Mogs /etc/at.allow. Edits /etc/at.deny to add restricted users" },

            "GEN003400": { "enabled": true, "desc": "!Mog's /var/spool/at/spool/" },
            "GEN003420": { "enabled": true, "desc": "!Mog's /var/spool/at/spool/" },

            "GEN003460": { "enabled": true, "desc": "!Mog's /etc/at.allow" },

            "GEN003480": { "enabled": true, "desc": "!Mog's /etc/at.deny" },

            "GEN003500": { "enabled": true, "desc": "!Edits /etc/security/limits.conf to disable core dumps." },

            "GEN003520": { "enabled": true, "desc": "!Mog's /var/crash" },

            "GEN003600": { "enabled": true, "desc": "!Mog's /etc/sysctl.conf, edits /etc/sysctl.conf to stop packet forwarding and to limit syn." },

            "GEN003660": { "enabled": true, "desc": "Sets Permissions, group, and user on /etc/syslog.conf. Restarts syslog on repair. Modifies auth.notice logging" },

            "GEN003700": { "enabled": true, "desc": "Turns off (chkconfig off) non-essential services." },

            "GEN003720": { "enabled": true, "desc": "!Mog's /etc/xinetd.conf" },
            "GEN003740": { "enabled": true, "desc": "!Mog's /etc/xinetd.conf" },

            "GEN003760": { "enabled": true, "desc": "!Mogs's /etc/services" },
            "GEN003780": { "enabled": true, "desc": "!Mog's /etc/services" },

            "GEN003860": { "enabled": true, "desc": "!Disables 'unnecessary services'.  Customize this section." },

            "GEN003865": { "enabled": true, "desc": "!Disables network analysis tools." },

            "GEN003960": { "enabled": true, "desc": "!Mogs /bin/traceroute" },
            "GEN003980": { "enabled": true, "desc": "!Mogs /bin/traceroute" },
            "GEN004000": { "enabled": true, "desc": "!Mogs /bin/traceroute" },

            "GEN004360": { "enabled": true, "desc": "!Mogs /etc/aliases." },
            "GEN004380": { "enabled": true, "desc": "!Mogs /etc/aliases." },

            "GEN004440": { "enabled": true, "desc": "! Edits /etc/mail/sendmail.cf. Sets LogLevel for Sendmail." },

            "GEN004460": { "enabled": true, "desc": "Sets Permissions, group, and user on /etc/syslog.conf. Restarts syslog on repair." },

            "GEN004480": { "enabled": true, "desc": "!Mog's /var/log/maillog" },
            "GEN004500": { "enabled": true, "desc": "!Mog's /var/log/maillog" },

            "GEN004540": { "enabled": true, "desc": "!Edits /etc/mail/sendmail.cf. Removes help command from sendmail." },

            "GEN004560": { "enabled": true, "desc": "!Edits /etc/mail/sendmail.cf. Removes version number from sendmail." },

            "GEN004580": { "enabled": true, "desc": "!Deletes all .forward files from home directories." },

            "GEN004640": { "enabled": true, "desc": "!Mog's /etc/aliases. Comments lines from /etc/aliases to remove decode command from sendmail." },

            "GEN004880": { "enabled": true, "desc": "!Mog's FTP Users' File.Creates it if it doesnt exist." },

            "GEN004900": { "enabled": false, "desc": "!Adds names of system accounts and accounts with UID < 500 to ftpusers deny list." },

            "GEN004920": { "enabled": false, "desc": "!Mog's FTP Users' File.Creates it if it doesnt exist." },
            "GEN004940": { "enabled": false, "desc": "!Mog's FTP Users' File.Creates it if it doesnt exist." },

            "GEN005000": { "enabled": true, "desc": "!Edits /etc/passwd, Sets false shell to users with UID < 500" },

            "GEN005320": { "enabled": true, "desc": "!Mog's /etc/snmp/snmp.conf." },
            "GEN005360": { "enabled": true, "desc": "!Mog's /etc/snmp/snmp.conf." },

            "GEN005400": { "enabled": true, "desc": "!Sets Permissions, group, and user on /etc/syslog.conf. Restarts syslog on repair." },
            "GEN005420": { "enabled": true, "desc": "!Sets Permissions, group, and user on /etc/syslog.conf. Restarts syslog on repair." },

            "GEN005500": { "enabled": true, "desc": "!Edits /etc/ssh/sshd_config. Sets SSH protocol to 2 and Sets ciphers" },

            "GEN005540": { "enabled": true, "desc": "!Mogs /etc/ssh/ssh_banner.Copies down /etc/issue." },

            "GEN005600": { "enabled": true, "desc": "!Mogs /etc/sysctl.conf. Stops IP forwarding." },

            "GEN005740": { "enabled": true, "desc": "!Mogs /etc/exports" },
            "GEN005760": { "enabled": true, "desc": "!Mogs /etc/exports" },

            "GEN006100": { "enabled": true, "desc": "!Mogs /etc/samba/smb.conf" },
            "GEN006120": { "enabled": true, "desc": "!Mogs /etc/samba/smb.conf" },
            "GEN006140": { "enabled": true, "desc": "!Mogs /etc/samba/smb.conf" },

            "GEN006160": { "enabled": true, "desc": "!Mogs /usr/bin/smbpasswd" },
            "GEN006180": { "enabled": true, "desc": "!Mogs /usr/bin/smbpasswd" },
            "GEN006200": { "enabled": true, "desc": "!Mogs /usr/bin/smbpasswd" },

            "GEN006260": { "enabled": true, "desc": "!Sets mode on /etc/news/hosts.nntp" },

            "GEN006280": { "enabled": true, "desc": "!Sets mode on /etc/news/hosts.nntp.nolimit" },

            "GEN006300": { "enabled": true, "desc": "!Sets mode on /etc/news/nnrp.access" },

            "GEN006320": { "enabled": true, "desc": "!Sets mode on /etc/news/passwd.nntp" },

            "GEN006340": { "enabled": true, "desc": "!Sets user/group on /etc/news." },
            "GEN006360": { "enabled": true, "desc": "!Sets user/group on /etc/news." },

            "GEN006520": { "enabled": true, "desc": "!Item not found in checklist. Mog's security_tools(iptables?)." },

            "GEN006620": { "enabled": true, "desc": "!Creates/Modifies /etc/hosts.allow and hosts.deny. Adds lines for generic networks. CHANGE ME!!" },

            "LNX00140": { "enabled": true, "desc": "!Enforces grub to not boot without password. Sets password to 'cfengine'. CHANGE ME!!!" },

            "LNX00160": { "enabled": true, "desc": "!Mog's /boot/grub/grub.conf" },

            "LNX00220": { "enabled": true, "desc": "!Mog's /etc/lilo.conf." },

            "LNX00320": { "enabled": true, "desc": " Deletes unnecessary users (ftp, news, gopher, etc) from /etc/passwd" },

            "LNX00340": { "enabled": true, "desc": " Deletes unnecessary users from /etc/passwd" },

            "LNX00360": { "enabled": true, "desc": "!Edits custom GDM  to enable X server audit level, sets timeout to 15 min. " },

            "LNX00400": { "enabled": true, "desc": "!Mog's /etc/security/access.conf." },
            "LNX00420": { "enabled": true, "desc": "!Mog's /etc/security/access.conf." },
            "LNX00440": { "enabled": true, "desc": "!Mog's /etc/security/access.conf." },

            "LNX00480": { "enabled": true, "desc": "!Mog's /etc/sysctl.conf." },
            "LNX00500": { "enabled": true, "desc": "!Mog's /etc/sysctl.conf." },
            "LNX00520": { "enabled": true, "desc": "!Mog's /etc/sysctl.conf." },

            "LNX00580": { "enabled": true, "desc": "Modifies /etc/inittab. restarts inittab if repaired.  Disables CTRL+ALT+DEL." },

            "LNX00620": { "enabled": false, "desc": "!Mog's /etc/securetty." },
            "LNX00640": { "enabled": false, "desc": "!Mog's /etc/securetty." },
            "LNX00660": { "enabled": false, "desc": "!Mog's /etc/securetty." },
        },
        
        "templates": { "bycontext":
                       {
                           "linux":
                           {
                               "/etc/hosts.allow": { "file": "/var/cfengine/files/etc/hosts.allow" },
                               "/etc/hosts.deny": { "file": "/var/cfengine/files/etc/hosts.deny" },
                               // GEN005540-Location where SSH login banner is stored.
                               "/etc/issue.net": { "file": "/var/cfengine/files/etc/issue.net" }
                           },

                           "!atos2":
                           {
                               "/etc/audit/audit.rules": { "file": "/var/cfengine/files/etc/audit/audit.rules" },
                               "/etc/pam.d/system-auth-ac": { "file": "/var/cfengine/files/etc/pam.d/system-auth-ac" },
                           },

                           "atos2":
                           {
                               "/etc/audit/audit.rules": { "file": "/var/cfengine/files/etc/audit/audit.rules.atos2" },
                               "/etc/pam.d/system-auth-ac": { "file": "/var/cfengine/files/etc/pam.d/system-auth-ac.atos2" }
                           }
                       }
                     },

        "services": { "bycontext":
                      {
                          "linux":
                          {
                              // GEN002720, GEN002740, GEN002760-Set to system log service name.
                              "syslog": "rsyslog"
                          }
                      }
                    },

        "files": { "bycontext":
                   {
                       "linux.m1":
                       {
                           // GEN001160
                           "orphan_exclude":
                           {
                               "dirs": [ "/gpfs", "/homeless", "/media", "/home" ],
                               "filenames": [ ]
                           }
                       },

                       "linux":
                       {
                           // GEN001160
                           "orphan_exclude": 
                           { 
                               "dirs": [ "/media", "/home" ],
                               "filenames": [ ]
                           }
                       }
                   }
                 },

// ###############################################################################
// #FILE EDITS SECTION:
// #Lines to (check for|insert into|delete from) files
// #LNX00140 - Grub Password insertion
// default_password;password --md5 $1$8fI020$YPs7MCo3A1ZkS7xagjYnb0;linux

        // /etc/audit/audit.rules
        "audit_rules":
        {
            // check: delete all, then enable editing
            "GEN002660": { "rules": [ "-D", "-e 1" ] },

            // Audit Failure causes kernel panic if "panic_on_auditf" class is set
            "GEN002660.panic_on_auditf":  { "rules": [ "-f 1" ] },
            "GEN002660.!panic_on_auditf": { "rules": [ "-f 2" ] },

            // Audit failed file and program access attempts
            "GEN002720": { "rules": [ "-a exit,always -S open -F success=0" ] },
            // Audit File and Program Deletion
            "GEN002740": { "rules": [ "-a exit,always -S unlink -S rmdir" ] },
            // Audit administrative, privelaged, and security actions.
            "GEN002760": { "rules":
                           [
                               "-w /etc/auditd.conf",
                               "-w /etc/audit.rules",
                               "-a exit,always -F arch=b64 -S settimeofday -S acct -S reboot -S swapon",
                               "-a exit,always -S settimeofday -S setrlimit -S setdomainname",
                               "-a exit,always -S sched_setparam -S sched_setscheduler"
                           ]
                         },

            //GEN002780- No longer in STIG checklist.

            //GEN002800 Logon/Logout
            //Auditd monitors this by default in the source code, as per STIG checklist.

            // Audit Discretionary Access Control Permission Modifications
            "GEN002820": { "rules":
                           [
                               "-a exit,always -S chmod -S fchmod -S chown -S chown32 -S fchown",
                               "-a exit,always -S fchown32 -S lchown -S lchown32"
                           ]
                         }

            // GEN002840- No longer in STIG checklist.
        },

        "edits":
        {
            "/etc/pam.d/system-auth-ac":
            {
                // Three Failed Login Attempts
                "GEN000460": [ "account required\\s*/lib/security/pam_tally.so deny=3 no_magic_root reset" ],

                // Password Character Mix and Password Reuse
                "GEN000600": [ ".*lcredit=-[1-9].*", ".*ucredit=-[1-9].*" ],
                "GEN000620": [ ".*dcredit=-[1-9].*" ],
                "GEN000640": [ ".*ocredit=-[1-9].*", ".*remember=[5-9].*" ]
            }
        }
    }
}
